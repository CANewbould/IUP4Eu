<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
 <title></title>
 <link rel="stylesheet" media="screen, projection, print" type="text/css" href="style.css"/>
<!-- source="tutorial.cr" -->
</head>
<body>

<a name="_0_aniuptutorial"></a><a name="aniuptutorial"></a><h1>An IUP Tutorial</h1>
<p> Original authors: Gustavo H. S. de O. Lyrio &amp; Antonio E. Scuri</p>

<p> Open Euphoria version: adapted by Charles A. Newbould</p>

<p> 
<p><br />
Index<br />
1. Introduction<br />
2. Hello World<br />
2.1 Initialization<br />
2.2 Creating a Dialog<br />
2.3 Adding Interaction<br />
2.4 Adding Layout Elements<br />
2.5 Improving the Layout<br />
3. Simple Notepad<br />
3.1 Main Dialog<br />
3.2 Adding a Menu<br />
3.3 Using Pre-defined Dialogs<br />
3.4 Custom Dialogs<br />
3.5 Adding a Toolbar and a Statusbar<br />
3.6 Defining Hot Keys<br />
3.7 Recent Files Menu and a Configuration File<br />
3.8 Clipboard Support<br />
3.9 More File Management (Drag&amp;Drop, Command Line, ...)<br />
3.10 Dynamic Layout<br />
3.11 External Help<br />
3.12 Final Considerations<br />
4. Simple Paint<br />
4.1  Loading and Saving Images<br />
4.2 Drawing with OpenGL<br />
4.3 Drawing with CD and Printing<br />
4.4 Interactive Zoom and Scrollbars<br />
4.5 Canvas Interaction and a ToolBox<br />
4.6 Image Processing and Final Considerations<br />
</p>

<p> 
<p><br />
5. Advanced Topics<br />
5.1 C<ins>  Encapsulation <br />
5.2 C</ins>  Modularization <br />
5.3 High Resolution Display <br />
5.4 Splash Screen, About and System Information<br />
5.5 Dynamic Libraries<br />
6. Simple Calc - Under Construction<br />
6.1 Data Matrix<br />
6.2 Plotting Data<br />
6.3 Numbers, Units and Formulas<br />
6.4 Embedded Help<br />
7. Simple Draw - Under Construction<br />
7.1 Hierarchy Tree for Objects<br />
7.2 Embedded Controls in Canvas<br />
7.3 Script Editor for Lua<br />
7.4 Background Processing using Multithread<br />
7.5 UTF-8 Character Encoding<br />
7.6 Multilanguage Interface<br />
</p>

<a name="_1_1introduction"></a><a name="1introduction"></a><h2>1. Introduction</h2>
<p> Hello and welcome to the IUP Tutorial. Our goal is to provide a walkthrough guide to develop IUP applications focused in people that haven't used IUP before. First of all it is necessary to describe what IUP is and how it can help you develop your application. IUP stands for "Interface User Portable". It is a multi-platform toolkit for building graphical user interfaces, offering a simple API, and its purpose is to allow the user interface source code of an application to be compiled in different systems without any modification. Supported systems include: GTK+ and Windows. As main advantages, IUP offers: high performance since it uses native interface elements, and a fast learning curve due to the simplicity of its API. Also, IUP uses an abstract layout model based on the boxes-and-glue paradigm from the TeX text editor making the dialog creation task more flexible and independent from the graphics system resolution.  </p>

<p> IUP has three concepts that any user has to understand: Elements, Attributes and Callbacks.  </p>

<a name="_2_elements"></a><a name="elements"></a><h3>Elements</h3>
<p> <strong>Elements</strong> are "every kind of interface element present in the application." IUP contains several user interface elements. The library's main characteristic is the use of native elements. This means that the drawing and management of a button or text box is done by the native interface system, not by IUP. This makes the application's appearance more similar to other applications in that system. On the other hand, the application's appearance can vary from one system to another. Besides, some additional controls are drawn by IUP,  and are independent from the native system. Dialogs are special  elements that represent every window created by IUP. Any application that uses IUP will be composed by one or more dialogs. Every dialog can contains one  or more controls inside.  </p>

<a name="_3_attributes"></a><a name="attributes"></a><h3>Attributes</h3>
<p> <strong>Attributes</strong> are "used to change or consult properties of  elements." Each element has a set of attributes that affects its behavior or its appearance.  Each attribute may work differently for each elements, but usually attributes with  the same name work the same. Attribute names are always upper case. But attribute values like "YES", "NO", "TOP", are case insensitive, so "Yes", "no", "top", and other variations will work.  </p>

<a name="_4_callbacks"></a><a name="callbacks"></a><h3>Callbacks</h3>
<p> <strong>Callbacks</strong> are "functions which notify the application that  some user interface event occurred." Usually callbacks will be called only when  the user interacts with the application elements. If the application register  the callback function, then the function will be called every time the event  occurs.</p>

<p> All we have seen until now is a short summary of what is behind the IUP toolkit and concepts that the developer needs to be familiarized with when programming with IUP. From now on, we are going to present how to build an IUP application from the most simple example possible to a complex and full of different resources application.</p>

<p> All examples are stored in the <em>examples</em> folder and have the <em>exw</em> extension, to signify that they are GUI applications. Note that the illustrative examples may not look exactly like those in the body of this text, depending on which operating system and, possibly, which version of IUP you are using.</p>

<a name="_5_2helloworld"></a><a name="2helloworld"></a><h2>2. Hello World</h2>
<a name="_6_21initialization"></a><a name="21initialization"></a><h3>2.1 Initialization</h3>
<p> The code bellow will shows how to open an IUP environment and displays a simple message. Each line of code is explained after the code.</p>

<p> For this first example the original C-language code is copied, inside an Open Euphoria comment block, before the Open Euphoria code equivalent is listed. Note how similar they are, especially when the Euphoria code is set in the form of a <tt>main</tt> routine.</p>

<p> Note also the numeric markers (1 to 7) as comment after the code lines; these link to the explanation which follows.</p>

<pre class="examplecode"><font color="#FF0055">-- example2_1.exw</font>

<font color="#FF0055">-- LyrioScuri Tutorial</font>

<font color="#FF0055">/* 
</font>
<font color="#330033">#include &lt;stdlib.h&gt;</font>
<font color="#330033">#include &lt;iup.h&gt;</font>

<font color="#330033">int main</font><font color="#880033">(</font><font color="#330033">int argc, char **argv</font><font color="#880033">)</font>
<font color="#880033">{</font>
<font color="#330033">  IupOpen</font><font color="#993333">(</font><font color="#330033">&amp;argc, &amp;argv</font><font color="#993333">)</font><font color="#330033">;</font>
  
<font color="#330033">  IupMessage</font><font color="#993333">(</font><font color="#330033">"Hello World 1"</font><font color="#330033">, </font><font color="#330033">"Hello world from IUP."</font><font color="#993333">)</font><font color="#330033">;</font>
  
<font color="#330033">  IupClose</font><font color="#993333">()</font><font color="#330033">;</font>
<font color="#0000FF">  return </font><font color="#330033">EXIT_SUCCESS;</font>
<font color="#880033">}</font>
<font color="#330033">*/</font>

<font color="#0000FF">include </font><font color="#330033">iup.ew                                      </font><font color="#FF0055">-- 1</font>

<font color="#0000FF">function </font><font color="#330033">main</font><font color="#880033">()</font>
<font color="#330033">    IupOpen</font><font color="#880033">()                                       </font><font color="#FF0055">-- 2</font>
<font color="#330033">    IupMessage</font><font color="#880033">(</font><font color="#330033">"Hello World 1"</font><font color="#330033">, </font><font color="#330033">"Hello from IUP"</font><font color="#880033">)   </font><font color="#FF0055">-- 3</font>
<font color="#FF0055">    --IupMainLoop()                                 -- 4</font>
<font color="#330033">    IupClose</font><font color="#880033">()                                      </font><font color="#FF0055">-- 5</font>
<font color="#0000FF">    return </font><font color="#330033">EXIT_SUCCESS                             </font><font color="#FF0055">-- 6</font>
<font color="#0000FF">end function</font>

<font color="#FF0055">-- execution</font>
<font color="#330033">main</font><font color="#880033">()                                              </font><font color="#FF0055">-- 7</font>
</pre>

<p> <img src="images/HelloWorld_1.png" alt="images/HelloWorld_1.png" caption="images/HelloWorld_1.png" /></p>

<p> The following text links the lines:</p>
<ol><li>The main IUP library is made available. This is all we need for our first example. (If Euphoria cannot find the relevant module then the program will exit with a message. Also, you may need to add a configuration file to the <em>examples</em> folder to ensure Euphoria can find the <em>iup.ew</em> module; an <em>eu.cfg</em> is provided in the <em>examples</em> folder.)
</li><li>Before running any of the IUP's functions, the function <tt>IupOpen</tt> must be called to initialize the toolkit. (Note that in IUP4Eu this routine doesn't take any arguments.)
</li><li>The next line creates and displays a message to the user using the <tt>IupMessage</tt> function. This function receives two arguments: <em>title</em> and <em>message</em>. The title is displayed at the top of the message window and the message is a text message displayed to the user. (Note that, depending on the IUP/OS combination, you may see an information icon in addition to the text message.)
</li><li>In this simple example there is no need to call <tt>IupMainLoop</tt> because <tt>IupMessage</tt> is self contained. Most programs need to call <tt>IupMainLoop</tt>. (In fact to include it in this example will stop the programming exiting this loop. To see how to avoid this, look at the next example.)
</li><li>Following, we have a <tt>IupClose</tt> function call. After running the last IUP function, <tt>IupClose</tt> must be run so that the toolkit can free internal memory and close the interface system.
</li><li>To simulate the C-language example, the Euphoria code is cast as a function, returning a value that signifies a successful exit.
</li><li>Again to parallel the C-language code we execute the <tt>main</tt> function. Note that Euphoria doesn't have a built-in <tt>main</tt>; note also that there is no need to trap or test the return value. (We could equally have cast <tt>main</tt> as a procedure but a function has been defined to retain the similarity with C.)
</li></ol>
<p>If you study the Lua version of this example you will find a call to  <tt>iup.MainLoopLevel</tt>.  It will check if <tt>iup.MainLoop</tt> was already called to avoid calling it again. This is useful only if your script  could be executed from inside another context, for regular applications there is no need for calling it.</p>

<p> The next example shows how you could address this.</p>

<pre class="examplecode"><font color="#FF0055">--example2_1a.exw</font>

<font color="#0000FF">include </font><font color="#330033">iup.ew                                        </font><font color="#FF0055">-- 1</font>

<font color="#0000FF">function </font><font color="#330033">main</font><font color="#880033">()                                       </font><font color="#FF0055">-- 2</font>
<font color="#330033">    IupOpen</font><font color="#880033">()                                         </font><font color="#FF0055">-- 3</font>
<font color="#330033">    IupMessage</font><font color="#880033">(</font><font color="#330033">"Hello World 1a"</font><font color="#330033">, </font><font color="#330033">"Hello from IUP"</font><font color="#880033">)    </font><font color="#FF0055">-- 4  </font>
<font color="#0000FF">    if </font><font color="#330033">IupMainLoopLevel</font><font color="#880033">() </font><font color="#330033">= 0 </font><font color="#0000FF">then                    </font><font color="#FF0055">-- 5</font>
<font color="#330033">        IupExitLoop</font><font color="#880033">()                                 </font><font color="#FF0055">-- 6</font>
<font color="#0000FF">    end if</font>
<font color="#330033">    IupClose</font><font color="#880033">()                                        </font><font color="#FF0055">-- 7</font>
<font color="#0000FF">    return </font><font color="#330033">EXIT_SUCCESS                               </font><font color="#FF0055">-- 8</font>
<font color="#0000FF">end function</font>

<font color="#FF0055">-- execution</font>
<font color="#330033">main</font><font color="#880033">()                                                </font><font color="#FF0055">-- 9</font>
</pre>

<p> As above the numeric comments are used to identify the processes.</p>
<ol><li>The main IUP library is made available.
</li><li>We continue to cast the example inside a <tt>main</tt> function.
</li><li>The function <tt>IupOpen</tt> initializes the toolkit.
</li><li>The next line creates and displays a message to the user using the <tt>IupMessage</tt> function. (The message is slightly different from in the last example, to indicate a different calling application.)
</li><li>We test for use of <tt>IupMainLoop</tt> by using <tt>IupMainLoopLevel</tt> to establish if the event loop is active.
</li><li>TWe use <tt>IupExitLoop</tt> to force a successful exit.
</li><li><tt>IupClose</tt> closes the toolkit.
</li><li>We return a suitable value for the function's operation.
</li><li>We execute <tt>main</tt>.
</li></ol>
<p>Note that this second example is not illustrating the conventional approach to IUP programming, which uses <tt>IupMainLoop</tt> explicitly, but rather to show that there can be multiple ways to achieve a given effect.</p>

<p> Normally we just call <tt>IupMainLoop</tt>, which listens for events and matches the event owner with a suitable function. You call <tt>IupMainLoop</tt> just once; <tt>IupMainLoopLevel</tt> is used to tell you if the main loop is already active. </p>

<a name="_7_iupapplications"></a><a name="iupapplications"></a><h2>IUP Applications</h2>
<a name="_8_22creatingadialog"></a><a name="22creatingadialog"></a><h3>2.2 Creating a Dialog</h3>
<p> Let's change the previos example a little bit to add our own dialog.</p>

<p> Dialogs are the core of IUP design and provide the structure for the "top-level-window", as it is known in other GUIs.</p>

<p> A distinguishing feature of IUP is the "bottom-up" approach to design: elements in a GUI are declared from the "inside" outwards, culminating in the declaration of the dialog as the main window.</p>

<p> IUP also provides compositional tools. These enable grouping of associated elements and, most importantly, manage the sizes and relative arrangements within such groups.</p>

<p> The main reason for IUP simplicity of use, however, comes from its universal use, for all types of elements, of attributes, where specific properties are assigned specific values.</p>

<pre class="examplecode"><font color="#FF0055">-- example2_2.exw</font>

<font color="#0000FF">include </font><font color="#330033">iup.ew</font>

<font color="#330033">IupOpen</font><font color="#880033">()</font>

<font color="#0000FF">atom </font><font color="#330033">lbl = IupLabel</font><font color="#880033">(</font><font color="#330033">"Hello world from IUP"</font><font color="#880033">)</font>
<font color="#0000FF">atom </font><font color="#330033">dlg = IupDialog</font><font color="#880033">(</font><font color="#330033">IupVbox</font><font color="#993333">(</font><font color="#0000FF">{</font><font color="#330033">lbl</font><font color="#0000FF">}</font><font color="#993333">)</font><font color="#880033">)</font>
<font color="#330033">IupSetAttribute</font><font color="#880033">(</font><font color="#330033">dlg, </font><font color="#330033">"TITLE"</font><font color="#330033">, </font><font color="#330033">"Hello World 2"</font><font color="#880033">)</font>
            
<font color="#330033">IupShowXY</font><font color="#880033">(</font><font color="#330033">dlg, IUP_CENTER, IUP_CENTER</font><font color="#880033">)</font>
<font color="#330033">IupMainLoop</font><font color="#880033">()</font>
<font color="#330033">IupClose</font><font color="#880033">()</font>
</pre>

<p> After opening the IUP session, we declared two new (<strong>atom</strong>) variables to hold IUP elements; one called <em>dlg</em> for our main dialog and another called <em>lbl</em>, to hold a label containing our hello message. Both variables, in typical Open Euphoria-style, are initialised on declaration. The label control takes the text string as its only argument. The main dialog is created using the <tt>IupDialog</tt> function. Its parameter is always a single element, which is nearly always a compositional one. Here, because we never need to refer to it again, we make it the result of creating a composition element using <tt>IupVbox</tt>. A <em>Vbox</em> in IUP is a control that orders all controls passed to it in a vertical direction. In this example, we are only passing one control (our label), but <tt>IupVbox</tt> is programmed to take a list of elements, hence the use of a one-element sequence here. In the next line we show one way in which IUP changes each control attribute (ie. property). By calling the function <tt>IupSetAttribute</tt> the programmer is able to specify what value a named attribute should carry in the specific context. In our sample, we are setting the main dialog's caption to "Hello World 2". This concludes the compositional section of our application. (Another compositional element is provided by <tt>IupHbox</tt>, which arranges its member elements horizontally rather than vertically. Before moving on, think for a minute what, if any, the use of this function would make!)</p>

<p> We now move on to the "action" section! The next function, called <tt>IupShowXY</tt>, tells IUP how and where to display the main dialog. In this example it is to be displayed at the centre of the screen, both horizontally and vertically, as the repeated values indicate.</p>

<p> Next comes that most important function, <tt>IupMainLoop</tt>, which we have introduced above. This function tells IUP to wait for events. Without it the program would simply go on, thereby ending the IUP session and terminating the Euphoria program, without dealing with any event. Why not try this out? Comment out this line, run your code and you will see the main dialog blink on the screen; the program ends just after it so you could easily miss the effect! It will prove to be a valuable exercise.</p>

<p> Note: <em>label</em> is a keyword in Euphoria, so you cannot use it as an identifier for a variable - hence the use of the alternative <em>lbl</em> here.</p>

<p> Note also, that for the purposes of generating the Open Euphoria wrapper, <em>iup.ew</em>, all the IUP C-language functions have been mapped into Euphoria <em>function</em>s, but that in several cases, and most in this example, these have been called in "VOID mode", that is, without attempting to trap the return value.</p>

<p> All IUP applications, from the most simple "hello world" to the most complex, follow this same code structure, so it well worth studying it and getting familiar with its form. It is also worth thinking about what sort of "template" most appeals to you. This example has a simple-flow layout, whereas earlier examples adopted a <tt>main</tt> routine approach (note that it could perfectly reasonably have been cast as a <em>procedure</em>). There is also a case to be made for adopting some form of indentation to show the IUP session more clearly [from after the call to <tt>IupOpen</tt>() to before the call to <tt>IupClose</tt>()], especially in the early stages of learning, to emphasise the nature of the process.</p>

<p> In the rest of this presentation I shall adopt the <tt>main</tt> <em>procedure</em> approach, because it has certain advantages for generalising your applications by allowing the passing of values through <tt>main</tt> at run time.</p>

<a name="_9_23addinginteraction"></a><a name="23addinginteraction"></a><h3>2.3 Adding Interaction</h3>
<p> In the previous section, we saw how to build a basic IUP application, but without any custom interaction with the dialog. In this section, we add interaction to our application using a button.  </p>

<p> Interaction is effected through <em>callbacks</em>. These are special functions defined by the programmer and  called by IUP when an event needs to be handled. To create a callback, the programmer must declare a function and put inside its body anything that he/she wants the application to do when the event occurs. After that, it is necessary to inform IUP that the function is, in fact, a callback. That is done calling the function <tt>IupSetCallback</tt>. This ensures that the function will be executed when a specific event ("action") occurs.</p>

<pre class="examplecode"><font color="#FF0055">-- example2_3.exw</font>

<font color="#0000FF">include </font><font color="#330033">iup.ew</font>

<font color="#0000FF">function </font><font color="#330033">btn_exit_cb</font><font color="#880033">( )</font>
<font color="#330033">    IupMessage</font><font color="#880033">(</font><font color="#330033">"Hello World Message"</font><font color="#330033">, </font><font color="#330033">"Hello from IUP"</font><font color="#880033">)</font>
<font color="#0000FF">    return </font><font color="#330033">IUP_CLOSE</font>
<font color="#0000FF">end function</font>

<font color="#330033">IupOpen</font><font color="#880033">()</font>

<font color="#0000FF">atom </font><font color="#330033">button = IupButton</font><font color="#880033">(</font><font color="#330033">"OK"</font><font color="#880033">)</font>
<font color="#0000FF">atom </font><font color="#330033">vbox = IupVbox</font><font color="#880033">(</font><font color="#993333">{</font><font color="#330033">button</font><font color="#993333">}</font><font color="#880033">)</font>
<font color="#0000FF">atom </font><font color="#330033">dlg = IupDialog</font><font color="#880033">(</font><font color="#330033">vbox</font><font color="#880033">)</font>
<font color="#330033">            IupSetAttribute</font><font color="#880033">(</font><font color="#330033">dlg, </font><font color="#330033">"TITLE"</font><font color="#330033">, </font><font color="#330033">"Hello World 3"</font><font color="#880033">)</font>
<font color="#330033">            IupSetAttribute</font><font color="#880033">(</font><font color="#330033">dlg, </font><font color="#330033">"SIZE"</font><font color="#330033">, </font><font color="#330033">"QUARTERxEIGHTH"</font><font color="#880033">)</font>
            
<font color="#330033">IupSetCallback</font><font color="#880033">(</font><font color="#330033">button, </font><font color="#330033">"ACTION"</font><font color="#330033">, Icallback</font><font color="#993333">(</font><font color="#330033">"btn_exit_cb"</font><font color="#993333">)</font><font color="#880033">)</font>

<font color="#330033">IupShowXY</font><font color="#880033">(</font><font color="#330033">dlg, IUP_CENTER, IUP_CENTER</font><font color="#880033">)</font>
<font color="#330033">IupMainLoop</font><font color="#880033">()</font>
<font color="#330033">IupClose</font><font color="#880033">()</font>
</pre>

<p> In the code, after the usual <em>include</em> and the call to <tt>IupOpen</tt>, we have added some new lines. These lines contain a regular function called <tt>btn_exit_cb</tt> that will be registered as our button callback. This function does nothing special: it just shows the "hello" message of the first example and closies the application, by returning code <em>IUP_CLOSE</em>.  </p>

<p> Note that we have added a new handle to make our vbox explicit, following the button declaration and before the dialog definition. It isn't necessary to do this, because the variable is never further referenced, but it does make the example code look cleaner!</p>

<p> There is then a new line, containing <tt>IupSetCallback</tt> which associates an action with an event-handling routine. The first argument is the widget, here the button, which initiates the event.The second argument is a global name for the event we wish to trap. Here we use the generalised term "ACTION". (The names of the available callback actions can be found at each control documentation). As with attribute names, actions are always written in upper-case. The final argument uses the function <tt>Icallback</tt> which links the event-handler's name directly with this event combination.</p>

<p> When executed, the application's dialog box will show up, and when the user presses the button, a hello message, alongside a button to close the application, are displayed. Although not profound, this small sample of code has covered the process of creating an IUP application, declaring elements and callbacks, and also handling an event. From now on, we are going to be introduced to more IUP controls and how to exploit these to improve our applications. </p>
</p></p>
</body></html>